{"version":3,"file":"polythene-core-raised-button.js","sources":["../../polythene-css-classes/raised-button.js","../src/raised-button.js"],"sourcesContent":["\nexport default {\n  component: \"pe-text-button pe-raised-button\",\n};\n","import { isServer, pointerStartMoveEvent, pointerEndMoveEvent, deprecation } from \"polythene-core\";\nimport classes from \"polythene-css-classes/raised-button\";\n\n// Don't export 'getElement': it will be the wrapped button component (set in polythene-xxx-raised-button)\n\nconst MAX_SHADOW_DEPTH = 5;\n\nlet tapStart,\n  tapEndAll = () => {},\n  downButtons = [];\n\nconst animateZ = (which, vnode) => {\n  const shadowDepthBase = vnode.state.shadowDepthBase;\n  const increase = vnode.attrs.increase || 1;\n  const shadowDepth = vnode.state.shadowDepth();\n  const newShadowDepth = which === \"down\" && shadowDepthBase < MAX_SHADOW_DEPTH\n    ? Math.min(shadowDepthBase + increase, MAX_SHADOW_DEPTH)\n    : which === \"up\"\n      ? Math.max(shadowDepth - increase, shadowDepthBase)\n      : shadowDepth;\n  if (newShadowDepth !== shadowDepth) {\n    vnode.state.shadowDepth(newShadowDepth);\n  }\n};\n\nconst tapHandler = (which, vnode) => {\n  if (which === \"down\") {\n    downButtons.push(Object.assign({}, vnode));\n  }\n  const animateOnTap = vnode.attrs.animateOnTap !== false ? true : false;\n  if (animateOnTap) {\n    animateZ(which, vnode);\n  }\n};\n\nconst initTapEvents = vnode => {\n  if (isServer) return;\n  tapStart = () => tapHandler(\"down\", vnode);\n  tapEndAll = () => {\n    downButtons.map(buttonVnode =>\n      tapHandler(\"up\", buttonVnode));\n    downButtons = [];\n  };\n  pointerStartMoveEvent.forEach(evt =>\n    vnode.dom.addEventListener(evt, tapStart));\n  pointerEndMoveEvent.forEach(evt =>\n    document.addEventListener(evt, tapEndAll));\n};\n\nconst clearTapEvents = vnode => {\n  pointerStartMoveEvent.forEach(evt =>\n    vnode.dom.removeEventListener(evt, tapStart));\n  pointerEndMoveEvent.forEach(evt =>\n    document.removeEventListener(evt, tapEndAll));\n};\n\nexport const getInitialState = (vnode, createStream) => {\n  const attrs = vnode.attrs;\n  const shadowDepthBase = attrs.shadowDepth !== undefined\n    ? attrs.shadowDepth\n    : attrs.z !== undefined // deprecated\n      ? attrs.z\n      : 1; \n  const shadowDepth = createStream(shadowDepthBase);\n  const tapEventsInited = createStream(false);\n  return {\n    shadowDepthBase,\n    shadowDepth,\n    tapEventsInited,\n    redrawOnUpdate: createStream.merge([shadowDepth])\n  };\n};\n\nexport const onMount = vnode => {\n  if (!vnode.dom) {\n    return;\n  }\n  const state = vnode.state;\n  const attrs = vnode.attrs;\n  if (attrs.z !== undefined) {\n    deprecation(\"RaisedButton\", \"z\", \"shadowDepth\");\n  }\n  if (!state.tapEventsInited()) {\n    initTapEvents(vnode);\n    state.tapEventsInited(true);\n  }\n};\n\nexport const onUnMount = vnode => {\n  if (vnode.state.tapEventsInited()) {\n    clearTapEvents(vnode);\n  }\n};\n\nexport const createProps = (vnode, { renderer: h, Shadow }) => {\n  const attrs = vnode.attrs;\n  const state = vnode.state;\n  const children = attrs.children || vnode.children || [];\n  return Object.assign(\n    {},\n    {\n      subClassName: [\n        classes.component,\n        attrs.className,\n      ].join(\" \"),\n      animateOnTap: false,\n      shadowComponent: h(Shadow, {\n        shadowDepth: attrs.disabled ? 0 : state.shadowDepth,\n        animated: true\n      }),\n      wash: attrs.wash !== undefined\n        ? attrs.wash\n        : false,\n      children\n    },\n    attrs,\n    {\n      className: null\n    }\n  );\n};\n\nexport const createContent = vnode =>\n  vnode.children;\n"],"names":["component","MAX_SHADOW_DEPTH","tapStart","tapEndAll","downButtons","animateZ","which","vnode","shadowDepthBase","state","increase","attrs","shadowDepth","newShadowDepth","Math","min","max","tapHandler","push","animateOnTap","initTapEvents","isServer","map","buttonVnode","pointerStartMoveEvent","forEach","dom","addEventListener","evt","pointerEndMoveEvent","document","clearTapEvents","removeEventListener","getInitialState","createStream","undefined","z","tapEventsInited","redrawOnUpdate","merge","onMount","deprecation","onUnMount","createProps","h","renderer","Shadow","children","subClassName","classes","className","join","shadowComponent","disabled","animated","wash","createContent"],"mappings":"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"}